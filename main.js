var h=Object.defineProperty;var C=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var k=Object.prototype.hasOwnProperty;var E=(s,e)=>{for(var t in e)h(s,t,{get:e[t],enumerable:!0})},L=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of v(e))!k.call(s,a)&&a!==t&&h(s,a,{get:()=>e[a],enumerable:!(i=C(e,a))||i.enumerable});return s};var T=s=>L(h({},"__esModule",{value:!0}),s);var O={};E(O,{default:()=>d});module.exports=T(O);var o=require("obsidian"),x=`
    body.is-focus-mode .mobile-toolbar,
    body.is-focus-mode .mobile-toolbar-container,
    body.is-focus-mode .workspace-drawer-tab-container {
        display: none !important;
    }
`,y=[{id:"task",path:"task.md",name:"\uD560 \uC77C \uBB38\uC11C \uC5F4\uAE30",icon:"lucide-square-check"},{id:"later",path:"later.md",name:"\uB098\uC911\uC5D0 \uBCF4\uAE30 \uC5F4\uAE30",icon:"lucide-library-big"},{id:"plan",path:"plan.md",name:"\uACC4\uD68D \uBB38\uC11C \uC5F4\uAE30",icon:"lucide-goal"},{id:"work",path:"work.md",name:"\uC791\uC5C5 \uBB38\uC11C \uC5F4\uAE30",icon:"lucide-file-pen"}],F=[{id:".",symbol:"\u22EF"},{id:"-",symbol:"\u2014"},{id:",",symbol:"\xB7"}],b="@",w="ordinary.md",d=class extends o.Plugin{async onload(){this.injectFocusStyles(),this.registerEditorSuggest(new m(this)),this.addRibbonIcon("lucide-save","\uB808\uAC70\uC2DC \uD30C\uC77C \uB9CC\uB4E4\uAE30",()=>{let e=this.app.workspace.getActiveFile();e?this.createLegacyFile(e):new o.Notice("\uD65C\uC131\uD654\uB41C \uD30C\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.")}),this.addRibbonIcon("lucide-git-fork","\uB85C\uCEEC \uADF8\uB798\uD504 \uC5F4\uAE30",()=>this.openGraphInSidebar());for(let e of y)this.addRibbonIcon(e.icon,e.name,()=>{this.openTargetFile(e.path)});this.addRibbonIcon("calendar","\uC77C\uC0C1\uB178\uD2B8 \uC5F4\uAE30",()=>this.openOrCreateOrdinaryNote()),this.addCommand({id:"copy-all-document",name:"\uBB38\uC11C \uC804\uCCB4 \uBCF5\uC0AC",editorCallback:e=>this.copyAll(e)}),this.addCommand({id:"cut-to-clipboard",name:"\uC798\uB77C\uB0B4\uAE30",icon:"lucide-scissors",editorCallback:e=>this.handleCutCopy(e,!0)}),this.addCommand({id:"copy-to-clipboard",name:"\uBCF5\uC0AC\uD558\uAE30",icon:"copy",editorCallback:e=>this.handleCutCopy(e,!1)}),this.addCommand({id:"toggle-focus-mode",name:"\uC9D1\uC911 \uBAA8\uB4DC \uD1A0\uAE00",callback:()=>this.toggleFocusMode()}),this.addCommand({id:"create-legacy-file",name:"\uD604\uC7AC \uBB38\uC11C\uC758 \uB808\uAC70\uC2DC \uD30C\uC77C \uB9CC\uB4E4\uAE30",checkCallback:e=>{let t=this.app.workspace.getActiveFile();return t?(e||this.createLegacyFile(t),!0):!1}}),this.addCommand({id:"open-localgraph-in-sidebar",name:"\uC624\uB978\uCABD \uC0AC\uC774\uB4DC\uBC14\uC5D0 \uB85C\uCEEC\uADF8\uB798\uD504 \uC5F4\uAE30",callback:()=>this.openGraphInSidebar()});for(let e of y)this.addCommand({id:`open-${e.id}-file`,name:e.name,callback:()=>this.openTargetFile(e.path)});this.addCommand({id:"open-ordinary-note",name:"\uC77C\uC0C1\uB178\uD2B8 \uC5F4\uAE30",callback:()=>this.openOrCreateOrdinaryNote()}),this.addCommand({id:"move-sidebar-panel",name:"\uC0AC\uC774\uB4DC\uBC14 \uD328\uB110 \uC774\uB3D9 (\uC120\uD0DD)",callback:()=>{this.openSidebarSelector(e=>{let t=`${e==="left"?"\uC67C\uCABD":"\uC624\uB978\uCABD"}\uC5D0\uC11C \uC774\uB3D9\uD560 \uD328\uB110 \uC120\uD0DD`;new p(this.app,e,i=>{this.moveLeafToOppositeSidebar(i,e)},t).open()})}}),this.addCommand({id:"close-sidebar-panel",name:"\uC0AC\uC774\uB4DC\uBC14 \uD328\uB110 \uB2EB\uAE30 (\uC120\uD0DD)",callback:()=>{this.openSidebarSelector(e=>{let t=`${e==="left"?"\uC67C\uCABD":"\uC624\uB978\uCABD"}\uC5D0\uC11C \uB2EB\uC744 \uD328\uB110 \uC120\uD0DD`;new p(this.app,e,i=>{i.detach(),new o.Notice("\uD328\uB110\uC774 \uB2EB\uD614\uC2B5\uB2C8\uB2E4.")},t).open()})}}),this.addCommand({id:"expand-selection-char-right",name:"\uC120\uD0DD \uC601\uC5ED \uD55C \uAE00\uC790 \uC624\uB978\uCABD\uC73C\uB85C \uD655\uC7A5",editorCallback:e=>this.expandChar(e,1)}),this.addCommand({id:"expand-selection-char-left",name:"\uC120\uD0DD \uC601\uC5ED \uD55C \uAE00\uC790 \uC67C\uCABD\uC73C\uB85C \uD655\uC7A5",editorCallback:e=>this.expandChar(e,-1)}),this.addCommand({id:"expand-selection-word-right",name:"\uC120\uD0DD \uC601\uC5ED \uB2E8\uC5B4 \uB2E8\uC704 \uC624\uB978\uCABD\uC73C\uB85C \uD655\uC7A5",editorCallback:e=>this.expandWord(e,"right")}),this.addCommand({id:"expand-selection-word-left",name:"\uC120\uD0DD \uC601\uC5ED \uB2E8\uC5B4 \uB2E8\uC704 \uC67C\uCABD\uC73C\uB85C \uD655\uC7A5",editorCallback:e=>this.expandWord(e,"left")}),this.addCommand({id:"swap-splits",name:"\uBD84\uD560 \uD0ED \uAD50\uD658",callback:()=>this.swapTabsBetweenTwoSplits()}),this.addCommand({id:"add-tags-property",name:"\uD0DC\uADF8 \uC18D\uC131 \uCD94\uAC00",icon:"tags",callback:()=>{let e=this.app.workspace.getActiveFile();e&&this.app.fileManager.processFrontMatter(e,t=>{t.hasOwnProperty("tags")||(t.tags=null)})}}),this.addCommand({id:"move-cursor-to-end",name:"\uCEE4\uC11C\uC640 \uD3EC\uCEE4\uC2A4\uB97C \uBB38\uC11C \uB05D\uC73C\uB85C \uC774\uB3D9",icon:"lucide-text-cursor",editorCallback:e=>this.moveCursorToEnd(e)}),this.addCommand({id:"move-cursor-to-start",name:"\uCEE4\uC11C\uC640 \uD3EC\uCEE4\uC2A4\uB97C \uBB38\uC11C \uCC98\uC74C\uC73C\uB85C \uC774\uB3D9",icon:"lucide-arrow-up-to-line",editorCallback:e=>this.moveCursorToStart(e)})}onunload(){document.body.classList.remove("is-focus-mode")}moveCursorToEnd(e){e.focus();let t=e.lineCount()-1,i=e.getLine(t).length,a={line:t,ch:i};e.setCursor(a),e.scrollIntoView({from:a,to:a},!0)}moveCursorToStart(e){e.focus();let t={line:0,ch:0};e.setCursor(t),e.scrollIntoView({from:t,to:t},!0)}async copyAll(e){await navigator.clipboard.writeText(e.getValue()),new o.Notice("\uBB38\uC11C \uC804\uCCB4\uAC00 \uBCF5\uC0AC\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}async handleCutCopy(e,t){let i=e.getSelection().length>0;if(!i){let n=e.getCursor(),r=e.getLine(n.line),l={line:n.line,ch:0},c={line:n.line,ch:r.length};e.setSelection(l,c)}let a=e.getSelection();if(a)try{if(await navigator.clipboard.writeText(a),t)e.replaceSelection("");else if(!i){let n=e.getCursor("to");e.setCursor(n)}}catch{new o.Notice("\uD074\uB9BD\uBCF4\uB4DC \uC811\uADFC \uAD8C\uD55C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.")}}toggleFocusMode(){document.body.classList.toggle("is-focus-mode")}injectFocusStyles(){let e=document.createElement("style");e.id="focus-mode-styles",e.textContent=x,document.head.appendChild(e),this.register(()=>e.detach())}async createLegacyFile(e){let t="legacy",i=(0,o.moment)().format("YYYYMMDDHHmmss"),a=(0,o.normalizePath)(`${t}/${e.basename}_legacy_${i}.md`);try{await this.app.vault.adapter.exists(t)||await this.app.vault.createFolder(t),await this.app.vault.copy(e,a),new o.Notice(`\uB808\uAC70\uC2DC \uD30C\uC77C \uC0DD\uC131 \uC644\uB8CC: ${e.basename}_legacy_${i}`)}catch{new o.Notice("\uD30C\uC77C \uBCF5\uC0AC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}}async openGraphInSidebar(){let{workspace:e}=this.app,t=e.getLeavesOfType("localgraph")[0]||e.getRightLeaf(!1);await t.setViewState({type:"localgraph",active:!0}),e.revealLeaf(t)}async openTargetFile(e){let t=this.app.vault.getAbstractFileByPath(e);t instanceof o.TFile&&await this.app.workspace.getLeaf(!1).openFile(t)}async openOrCreateOrdinaryNote(){try{let e=this.app.vault.getAbstractFileByPath(w);e instanceof o.TFile||(e=await this.app.vault.create(w,""));let t=this.app.workspace.getLeaf(!1);await t.openFile(e);let i=t.view.editor,a=`### ${(0,o.moment)().format("MM\uC6D4 DD\uC77C (ddd)")}`,n=i.getValue();if(!n.includes(a)){let l=n.length>0?`
`:"";i.replaceRange(`${l}${a}
`,{line:i.lineCount(),ch:0})}let r=i.lineCount()-1;i.setCursor({line:r,ch:i.getLine(r).length}),i.scrollIntoView({from:i.getCursor(),to:i.getCursor()},!0),i.focus()}catch{new o.Notice("\uC77C\uC0C1\uB178\uD2B8 \uCC98\uB9AC \uC911 \uC624\uB958\uAC00 \uBC1C\uC0DD\uD588\uC2B5\uB2C8\uB2E4.")}}openSidebarSelector(e){let t=new class extends o.SuggestModal{getSuggestions(){return["left","right"]}renderSuggestion(i,a){a.setText(i==="left"?"\uC67C\uCABD \uC0AC\uC774\uB4DC\uBC14":"\uC624\uB978\uCABD \uC0AC\uC774\uB4DC\uBC14")}onChooseSuggestion(i){e(i)}}(this.app);t.setPlaceholder("\uC0AC\uC774\uB4DC\uBC14\uB97C \uC120\uD0DD\uD558\uC138\uC694"),t.open()}moveLeafToOppositeSidebar(e,t){let i=t==="left"?"right":"left",a=e.getViewState(),n=i==="left"?this.app.workspace.getLeftLeaf(!1):this.app.workspace.getRightLeaf(!1);n&&n.setViewState(a).then(()=>{e.detach(),this.app.workspace.revealLeaf(n),new o.Notice(`\uD328\uB110\uC774 ${i==="left"?"\uC67C\uCABD":"\uC624\uB978\uCABD"}\uC73C\uB85C \uC774\uB3D9\uB418\uC5C8\uC2B5\uB2C8\uB2E4.`)})}updateSelections(e,t){let i=e.listSelections().map(a=>({anchor:a.anchor,head:t(a)}));e.setSelections(i)}expandChar(e,t){this.updateSelections(e,i=>{let a=e.getLine(i.head.line),n=Math.max(0,Math.min(a.length,i.head.ch+t));return{line:i.head.line,ch:n}})}expandWord(e,t){this.updateSelections(e,i=>{let{line:a,ch:n}=i.head,r=e.getLine(a);if(t==="left"){let c=r.substring(0,n).match(/(\S+\s*|\s+)$/);return{line:a,ch:c?n-c[0].length:0}}else{let c=r.substring(n).match(/^(\s*\S+|\s+)/);return{line:a,ch:c?n+c[0].length:r.length}}})}async swapTabsBetweenTwoSplits(){let e=this.app.workspace,t=e.getLayout??e._getLayout;if(typeof t!="function"){new o.Notice("\uB808\uC774\uC544\uC6C3\uC744 \uAC00\uC838\uC62C \uC218 \uC5C6\uC2B5\uB2C8\uB2E4.");return}let i=t.call(e),a=i?.main,n=u(a);if(!n){new o.Notice("\uD604\uC7AC \uB450 \uBD84\uD560\uC5D0\uC11C\uB9CC \uB3D9\uC791\uD569\uB2C8\uB2E4.");return}let[r,l]=n.children,c=P(i,n.__path,[l,r]),S=[e.setLayout,e.changeLayout,e.loadLayout];for(let f of S)if(typeof f=="function")try{await f.call(e,c);return}catch{}new o.Notice("\uB808\uC774\uC544\uC6C3 \uC801\uC6A9 \uC2E4\uD328: \uD50C\uB7EC\uADF8\uC778 \uBC84\uC804/\uD658\uACBD\uC744 \uD655\uC778\uD558\uC138\uC694.")}},p=class extends o.SuggestModal{constructor(t,i,a,n){super(t);this.sidebar=i;this.action=a;this.setPlaceholder(n)}getSuggestions(t){let i=[],a=this.sidebar==="left"?this.app.workspace.leftSplit:this.app.workspace.rightSplit;return this.app.workspace.iterateAllLeaves(n=>{n.getRoot()===a&&i.push({name:n.getDisplayText()||n.view.getViewType(),leaf:n})}),i.filter(n=>n.name.toLowerCase().includes(t.toLowerCase()))}renderSuggestion(t,i){i.createEl("div",{text:t.name})}onChooseSuggestion(t){this.action(t.leaf)}};function u(s,e=["main"]){if(!s)return null;let t=s.children;if(Array.isArray(t)&&t.length===2){let a={...s};return a.__path=e,a}if(Array.isArray(t))for(let a=0;a<t.length;a++){let n=u(t[a],e.concat(["children",a]));if(n)return n}let i=["root","container","content"];for(let a of i)if(s[a]){let n=u(s[a],e.concat([a]));if(n)return n}return null}function P(s,e,t){let i=g(s),a=i;for(let n=0;n<e.length;n++){let r=e[n];a[r]=g(a[r]),a=a[r]}return Array.isArray(a.children)&&a.children.length===2&&(a.children=t.map(g)),i}function g(s){return s==null?s:JSON.parse(JSON.stringify(s))}var m=class extends o.EditorSuggest{constructor(e){super(e.app)}onTrigger(e,t){let a=t.getLine(e.line).substring(0,e.ch).match(new RegExp(`\\${b}([^\\${b}\\s]*)$`));return a?{start:{line:e.line,ch:a.index},end:e,query:a[1]}:null}getSuggestions(e){let t=e.query.toLowerCase();return F.filter(i=>i.id.toLowerCase().includes(t))}renderSuggestion(e,t){t.setText(`${e.id} ${e.symbol}`)}selectSuggestion(e){this.context?.editor.replaceRange(e.symbol,this.context.start,this.context.end)}};
